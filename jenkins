pipeline{
    agent any
    environment{
        DOCKERHUB_CREDENTIALS=credentials('dockerhub')
        IMAGENAME=
        GITREPO=
        BRANCH=main
    }
    stages{
        stage('checkout'){
            echo 'cloning to the repo'
            git branch: "${BRANCH}", url: "${GITREPO}"
        }
        stage('build image'){
            echo 'building docker image'
            bat "docker build -t ${IMAGENAME}"
        }
        stage('push image'){
            echo 'pushing the image to dockerhub'
            bat "docker login -u ${DOCKERHUB_CREDENTIALS_USR} -p ${DOCKERHUB_CREADENTIALS_PSW}"
            bat "docker push ${IMAGENAME}"
        }
    }
    post {
        success{
            echo 'pipeline executed successfully'
        }
        failure{
            echo 'pipeline failed'
        }
    }
}